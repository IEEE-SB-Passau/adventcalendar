@import helper._
@import org.ieee_passau.models.{User, UserRegistration}
@import org.ieee_passau.views.html.bootstrap3._
@import org.ieee_passau.views.html.main
@import play.api.data.Form
@import play.api.i18n.{Lang, Messages}
@import play.api.mvc.{Flash, RequestHeader}
@import  play.twirl.api.Html
@(registrationForm: Form[UserRegistration], useCaptcha: Boolean)(implicit flash: Flash, sessionUser: Option[User], requestHeader: RequestHeader, lang: Lang)

@main(Messages("nav.user.register")) {
    @if(useCaptcha) {
        <script src='https://www.google.com/recaptcha/api.js'></script>
    }
    <div class="well col-md-8 col-md-offset-2">
        @form(org.ieee_passau.controllers.routes.UserController.create, 'class -> "form-horizontal") {
            @CSRF.formField
            <fieldset>
                @text(registrationForm("username"), label = Messages("user.username") + "*", placeholder = Messages("user.username"), offset = "col-sm-3", width = "col-sm-9")
                @password2(registrationForm("password"), registrationForm("password.main"), registrationForm("password.repeat"),
                    label1 = Messages("user.password") + "*", label2 = " " + Messages("user.password.repeat") + "*",
                    placeholder = Messages("user.password"), help = Messages("user.help.password"),
                    offset = "col-sm-3", width = "col-sm-9")

                <div class="form-group @if(registrationForm("email").hasErrors || registrationForm.errors("invalidEmail").nonEmpty ) { has-error }">
                    <label class="col-sm-3 control-label">@(Messages("user.email") + "*")</label>
                    <div class="col-sm-9">
                        <input type="text"
                               class="form-control"
                               id="@registrationForm("email").id"
                               name="@registrationForm("email").name"
                               value="@registrationForm("email").value.getOrElse("")"
                               placeholder="@Messages("user.email")" />
                        <span class="help-block">@{ registrationForm("email").error.map { error => Messages(error.message) }}</span>
                        <span class="help-block">@{ registrationForm.errors("invalidEmail").map { error => Messages(error.message) }}</span>
                    </div>
                </div>

                @text(registrationForm("school"), label = Messages("user.school"), placeholder = Messages("user.school"), offset = "col-sm-3", width = "col-sm-9")
                @text(registrationForm("semester"), label = Messages("user.semester"), placeholder = Messages("user.semester"), offset = "col-sm-3", width = "col-sm-9")
                @text(registrationForm("studySubject"), label = Messages("user.studysubject"), placeholder = Messages("user.studysubject"), offset = "col-sm-3", width = "col-sm-9")

                <div class="form-group">
                    @if(useCaptcha) {
                        <div class="col-sm-offset-3 col-sm-6" style="padding-left: 30px;">
                            <div class="form-group @if(registrationForm("g-recaptcha-response").hasErrors || registrationForm.errors("g-recaptcha-response").nonEmpty ) { has-error }">
                                <div class="g-recaptcha" data-sitekey="@play.Configuration.root().getString("captcha.sitekey")"></div>
                                <span class="help-block">@{ registrationForm("g-recaptcha-response").error.map { error => Messages(error.message) }}</span>
                            </div>
                        </div>
                        <div class="col-sm-3">
                            <button id="submit" type="submit" value="Submit" class="btn btn-primary">@Messages("nav.user.register")</button>
                        </div>
                    } else {
                        <input type="hidden" name="g-recaptcha-response" value="" />
                        <div class="col-sm-offset-3 col-sm-9">
                            <button id="submit" type="submit" value="Submit" class="btn btn-primary">@Messages("nav.user.register")</button>
                        </div>
                    }
                </div>
            </fieldset>

        }
        <div class="pull-right">
            <small>@Html(Messages("user.help.register"))</small>
        </div>
    </div>
}
